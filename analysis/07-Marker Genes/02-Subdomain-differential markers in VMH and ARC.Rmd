---
title: "02-Subdomain-differential markers in VMH and ARC"
author: "Bernard Mulvey"
date: "2023-11-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.height = 10,fig.width = 7,include = FALSE)
knitr::opts_chunk$set(fig.width=7,fig.height=10)
#### sets tab autocompletion for directories to begin from the directory containing the .Rproj session, instead of the script's directory if different
knitr::opts_knit$set(root.dir = here::here())

library(data.table)
library(Biostrings)
library(ggplot2)
library(gridExtra)
library(SpatialExperiment)
library(spatialLIBD)
require(colorout)
source("~/.R/calc_tau_for_cellOrTissueSpecificity_metric.R")
ColorOut()
options("styler.addins_style_transformer" = "biocthis::bioc_style()")

## change write.table to output a TSV without quotes or rownames by default
library(default)
default(write.table) <- list(row.names=F,col.names=T,sep='\t',quote=F)

theme_set(theme_bw()+theme(axis.text.x = element_text(size = 14), axis.title.x = element_text(size = 16), axis.text.y = element_text(size = 14), axis.title.y = element_text(size =16), plot.title = element_text(size = 20,hjust=0.5), strip.text = element_text(size=18), legend.text = element_text(size=10), legend.title = element_text(size=11,hjust=0.5)))
```


load required files
```{r}
hyp2 <- readRDS("data/03-QC_filters/hypN9_umi275_gene166_chrm50_lognorm_111723.RDS")

bscl <- list.files("data/06-BayesSpace",pattern=".txt",recursive = T,full.names = T)

bscls <- lapply(bscl,FUN=fread)
names(bscls) <- bscl
# replace file paths with informative short labels
names(bscls) <- gsub(names(bscls),pattern="^.*9-15-20-31_out\\/BSpace_(.*)\\.txt$",replacement="\\1")
names(bscls) <- gsub(names(bscls),pattern="^.*60kiter.*\\/BSpace_(.*)\\.txt$",replacement=paste0("\\1","_60kiter"))


```

## Use scran::scoreMarkers(...,full.stats=T) to get results compatabile w finding markers to separate highly related clusters for favorite subset of HI ITER clustering results: 
lmbna_nnsvg10_15: 3/5 (ARC); 11/12 (VMH)
lmbna_nnsvg10_20: 14/18 (ARC); 7/9/13 (VMH)
nnsvg10_31 clusters 1/7/8/21 (ARC); 3, 4, 6, 19, 20, 29 (VMH)

```{r}
bscls <- bscls[names(bscls) %in% grep(names(bscls),pattern="HARMONYlmbna_nnsvg10_60kiter",value=T)]
#^ order: k15,20,31-use same below
keepclusts <- list(
    arc15=c("X3","X5"),
    vmh15=c("X11","X12"),
    arc20=c("X14","X18"),
    vmh20=c("X7","X9","X13"),
    arc31=c("X1","X7","X8","X21"),
    vmh31=c("X3","X4","X6","X19","X20","X29")
)
```


## following OSCA: http://bioconductor.org/books/3.17/OSCA.basic/marker-detection.html#obtaining-the-full-effects

```{r}
# extract gene annotation table to join back to results
tmprowdat <- as.data.table(rowData(hyp2))

## iterate through clustering results: assign current clustering result to the hyp2$label column, subset to those spots, identify markers within those assignments, return marker test outputs, proceed to next assignment set 

# parallelize within individual calls to scran, otherwise we're cloning the whole spe over and over
bpparam <- MulticoreParam(workers=8)
register(bpparam)

i<-1
select.vmharc.markers <- list()
for (i in c(1:(2*length(bscls)))){
    hyptmp <- hyp2
    y <- copy(bscls)[[ceiling(i/2)]]
    setnames(y,2,"cl")
    y[,cl:=paste0("X",cl)]
    y <- as.data.frame(y)
    rownames(y) <- y$rn
    # safeguard against reordered rows
    y <- y[rownames(colData(hyp2)),]
    # row names as gene symbols for sanity
    colLabels(hyptmp) <- as.factor(y$cl)
    hyptmp <- hyptmp[,hyptmp$label %in% keepclusts[[i]]]
    hyptmp$label <- droplevels(hyptmp$label)
    rm(y)
    gc(full=T)
    
    select.vmharc.markers[[i]] <- scoreMarkers(hyptmp,colLabels(hyptmp),full.stats=T)
    names(select.vmharc.markers)[i] <- paste0(names(bscls)[i],"_",names(keepclusts)[i])
    rm(hyptmp)
    gc(full=T)
}
rm(i,bpparam)

### save results as RDS
saveRDS(select.vmharc.markers,file="data/07-Marker_genes/02-nnsvg10_HRM-lmbna_bspace_VMHandARC-clustPair-diffmarkers.RDS")

```

```{r}
sessionInfo()
sessioninfo::session_info()

```

R version 4.3.1 (2023-06-16)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS Ventura 13.6

Matrix products: default
BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Chicago
tzcode source: internal

attached base packages:
[1] parallel  stats4    stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] scran_1.30.0                BiocParallel_1.36.0        
 [3] scater_1.30.1               scuttle_1.12.0             
 [5] spatialLIBD_1.13.4          SpatialExperiment_1.12.0   
 [7] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0
 [9] Biobase_2.62.0              GenomicRanges_1.54.1       
[11] MatrixGenerics_1.14.0       matrixStats_1.1.0          
[13] colorout_1.3-0              gridExtra_2.3              
[15] Biostrings_2.70.1           GenomeInfoDb_1.38.1        
[17] XVector_0.42.0              IRanges_2.36.0             
[19] S4Vectors_0.40.1            BiocGenerics_0.48.1        
[21] data.table_1.14.8           ggplot2_3.4.4              
[23] rlang_1.1.2                

loaded via a namespace (and not attached):
  [1] later_1.3.1                   BiocIO_1.12.0                
  [3] bitops_1.0-7                  filelock_1.0.2               
  [5] fields_15.2                   tibble_3.2.1                 
  [7] polyclip_1.10-6               XML_3.99-0.15                
  [9] lifecycle_1.0.4               edgeR_4.0.1                  
 [11] doParallel_1.0.17             rprojroot_2.0.4              
 [13] lattice_0.22-5                MASS_7.3-60                  
 [15] magrittr_2.0.3                sass_0.4.7                   
 [17] openxlsx_4.2.5.2              limma_3.58.1                 
 [19] plotly_4.10.3                 rmarkdown_2.25               
 [21] jquerylib_0.1.4               yaml_2.3.7                   
 [23] metapod_1.10.0                httpuv_1.6.12                
 [25] spam_2.10-0                   zip_2.3.0                    
 [27] sessioninfo_1.2.2             cowplot_1.1.1                
 [29] DBI_1.1.3                     RColorBrewer_1.1-3           
 [31] golem_0.4.1                   maps_3.4.1.1                 
 [33] abind_1.4-5                   zlibbioc_1.48.0              
 [35] rvest_1.0.3                   purrr_1.0.2                  
 [37] msigdbr_7.5.1                 RCurl_1.98-1.13              
 [39] tweenr_2.0.2                  rappdirs_0.3.3               
 [41] reactable_0.4.4               GenomeInfoDbData_1.2.11      
 [43] ggrepel_0.9.4                 irlba_2.3.5.1                
 [45] dqrng_0.3.1                   DelayedMatrixStats_1.24.0    
 [47] svglite_2.1.2                 codetools_0.2-19             
 [49] DelayedArray_0.28.0           DT_0.30                      
 [51] xml2_1.3.5                    ggforce_0.4.1                
 [53] tidyselect_1.2.0              farver_2.1.1                 
 [55] viridis_0.6.4                 ScaledMatrix_1.10.0          
 [57] shinyWidgets_0.8.0            BiocFileCache_2.10.1         
 [59] webshot_0.5.5                 GenomicAlignments_1.38.0     
 [61] jsonlite_1.8.7                BiocNeighbors_1.20.0         
 [63] ellipsis_0.3.2                iterators_1.0.14             
 [65] systemfonts_1.0.5             foreach_1.5.2                
 [67] tools_4.3.1                   Rcpp_1.0.11                  
 [69] glue_1.6.2                    SparseArray_1.2.2            
 [71] xfun_0.41                     here_1.0.1                   
 [73] dplyr_1.1.4                   withr_2.5.2                  
 [75] BiocManager_1.30.22           fastmap_1.1.1                
 [77] bluster_1.12.0                fansi_1.0.5                  
 [79] rsvd_1.0.5                    digest_0.6.33                
 [81] R6_2.5.1                      mime_0.12                    
 [83] colorspace_2.1-0              RSQLite_2.3.3                
 [85] config_0.3.2                  utf8_1.2.4                   
 [87] tidyr_1.3.0                   generics_0.1.3               
 [89] rtracklayer_1.62.0            httr_1.4.7                   
 [91] htmlwidgets_1.6.2             S4Arrays_1.2.0               
 [93] pkgconfig_2.0.3               gtable_0.3.4                 
 [95] blob_1.2.4                    htmltools_0.5.7              
 [97] dotCall64_1.1-0               scales_1.2.1                 
 [99] kableExtra_1.3.4              png_0.1-8                    
[101] attempt_0.3.1                 knitr_1.45                   
[103] rstudioapi_0.15.0             reshape2_1.4.4               
[105] rjson_0.2.21                  visNetwork_2.1.2             
[107] curl_5.1.0                    cachem_1.0.8                 
[109] stringr_1.5.1                 BiocVersion_3.18.1           
[111] vipor_0.4.5                   AnnotationDbi_1.64.1         
[113] restfulr_0.0.15               pillar_1.9.0                 
[115] grid_4.3.1                    vctrs_0.6.4                  
[117] promises_1.2.1                BiocSingular_1.18.0          
[119] beachmat_2.18.0               dbplyr_2.4.0                 
[121] cluster_2.1.4                 xtable_1.8-4                 
[123] beeswarm_0.4.0                paletteer_1.5.0              
[125] evaluate_0.23                 magick_2.8.1                 
[127] cli_3.6.1                     locfit_1.5-9.8               
[129] compiler_4.3.1                Rsamtools_2.18.0             
[131] crayon_1.5.2                  hypeR_2.0.0                  
[133] rematch2_2.1.2                ggbeeswarm_0.7.2             
[135] plyr_1.8.9                    stringi_1.8.1                
[137] viridisLite_0.4.2             babelgene_22.9               
[139] munsell_0.5.0                 lazyeval_0.2.2               
[141] Matrix_1.6-3                  ExperimentHub_2.10.0         
[143] benchmarkme_1.0.8             sparseMatrixStats_1.14.0     
[145] bit64_4.0.5                   KEGGREST_1.42.0              
[147] statmod_1.5.0                 shiny_1.8.0                  
[149] interactiveDisplayBase_1.40.0 AnnotationHub_3.10.0         
[151] igraph_1.5.1                  memoise_2.0.1                
[153] bslib_0.5.1                   benchmarkmeData_1.0.4        
[155] bit_4.0.5                    

###
Session info ───────────────────────────────────────────────────────────
 setting  value
 version  R version 4.3.1 (2023-06-16)
 os       macOS Ventura 13.6
 system   aarch64, darwin20
 ui       RStudio
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Chicago
 date     2023-12-16
 rstudio  2023.09.1+494 Desert Sunflower (desktop)
 pandoc   3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────
 package                * version   date (UTC) lib source
 abind                    1.4-5     2016-07-21 [1] CRAN (R 4.3.0)
 AnnotationDbi            1.64.1    2023-11-02 [1] Bioconductor
 AnnotationHub            3.10.0    2023-10-24 [1] Bioconductor
 attempt                  0.3.1     2020-05-03 [1] CRAN (R 4.3.0)
 babelgene                22.9      2022-09-29 [1] CRAN (R 4.3.0)
 beachmat                 2.18.0    2023-10-24 [1] Bioconductor
 beeswarm                 0.4.0     2021-06-01 [1] CRAN (R 4.3.0)
 benchmarkme              1.0.8     2022-06-12 [1] CRAN (R 4.3.0)
 benchmarkmeData          1.0.4     2020-04-23 [1] CRAN (R 4.3.0)
 Biobase                * 2.62.0    2023-10-26 [1] Bioconductor
 BiocFileCache            2.10.1    2023-10-26 [1] Bioconductor
 BiocGenerics           * 0.48.1    2023-11-02 [1] Bioconductor
 BiocIO                   1.12.0    2023-10-24 [1] Bioconductor
 BiocManager              1.30.22   2023-08-08 [1] CRAN (R 4.3.0)
 BiocNeighbors            1.20.0    2023-10-24 [1] Bioconductor
 BiocParallel           * 1.36.0    2023-10-26 [1] Bioconductor
 BiocSingular             1.18.0    2023-10-24 [1] Bioconductor
 BiocVersion              3.18.1    2023-11-15 [1] Bioconductor
 Biostrings             * 2.70.1    2023-10-26 [1] Bioconductor
 bit                      4.0.5     2022-11-15 [1] CRAN (R 4.3.0)
 bit64                    4.0.5     2020-08-30 [1] CRAN (R 4.3.0)
 bitops                   1.0-7     2021-04-24 [1] CRAN (R 4.3.0)
 blob                     1.2.4     2023-03-17 [1] CRAN (R 4.3.0)
 bluster                  1.12.0    2023-10-24 [1] Bioconductor
 bslib                    0.5.1     2023-08-11 [1] CRAN (R 4.3.0)
 cachem                   1.0.8     2023-05-01 [1] CRAN (R 4.3.0)
 cli                      3.6.1     2023-03-23 [1] CRAN (R 4.3.0)
 cluster                  2.1.4     2022-08-22 [1] CRAN (R 4.3.0)
 codetools                0.2-19    2023-02-01 [1] CRAN (R 4.3.0)
 colorout               * 1.3-0     2023-11-01 [1] local (/Users/bmulvey/Desktop/colorout)
 colorspace               2.1-0     2023-01-23 [1] CRAN (R 4.3.0)
 config                   0.3.2     2023-08-30 [1] CRAN (R 4.3.0)
 cowplot                  1.1.1     2020-12-30 [1] CRAN (R 4.3.0)
 crayon                   1.5.2     2022-09-29 [1] CRAN (R 4.3.0)
 curl                     5.1.0     2023-10-02 [1] CRAN (R 4.3.1)
 data.table             * 1.14.8    2023-02-17 [1] CRAN (R 4.3.0)
 DBI                      1.1.3     2022-06-18 [1] CRAN (R 4.3.0)
 dbplyr                   2.4.0     2023-10-26 [1] CRAN (R 4.3.1)
 DelayedArray             0.28.0    2023-11-06 [1] Bioconductor
 DelayedMatrixStats       1.24.0    2023-10-24 [1] Bioconductor
 digest                   0.6.33    2023-07-07 [1] CRAN (R 4.3.0)
 doParallel               1.0.17    2022-02-07 [1] CRAN (R 4.3.0)
 dotCall64                1.1-0     2023-10-17 [1] CRAN (R 4.3.1)
 dplyr                    1.1.4     2023-11-17 [1] CRAN (R 4.3.1)
 dqrng                    0.3.1     2023-08-30 [1] CRAN (R 4.3.0)
 DT                       0.30      2023-10-05 [1] CRAN (R 4.3.1)
 edgeR                    4.0.1     2023-10-29 [1] Bioconductor
 ellipsis                 0.3.2     2021-04-29 [1] CRAN (R 4.3.0)
 evaluate                 0.23      2023-11-01 [1] CRAN (R 4.3.1)
 ExperimentHub            2.10.0    2023-10-24 [1] Bioconductor
 fansi                    1.0.5     2023-10-08 [1] CRAN (R 4.3.1)
 farver                   2.1.1     2022-07-06 [1] CRAN (R 4.3.0)
 fastmap                  1.1.1     2023-02-24 [1] CRAN (R 4.3.0)
 fields                   15.2      2023-08-17 [1] CRAN (R 4.3.0)
 filelock                 1.0.2     2018-10-05 [1] CRAN (R 4.3.0)
 foreach                  1.5.2     2022-02-02 [1] CRAN (R 4.3.0)
 generics                 0.1.3     2022-07-05 [1] CRAN (R 4.3.0)
 GenomeInfoDb           * 1.38.1    2023-11-08 [1] Bioconductor
 GenomeInfoDbData         1.2.11    2023-11-10 [1] Bioconductor
 GenomicAlignments        1.38.0    2023-10-24 [1] Bioconductor
 GenomicRanges          * 1.54.1    2023-10-30 [1] Bioconductor
 ggbeeswarm               0.7.2     2023-04-29 [1] CRAN (R 4.3.0)
 ggforce                  0.4.1     2022-10-04 [1] CRAN (R 4.3.0)
 ggplot2                * 3.4.4     2023-10-12 [1] CRAN (R 4.3.1)
 ggrepel                  0.9.4     2023-10-13 [1] CRAN (R 4.3.1)
 glue                     1.6.2     2022-02-24 [1] CRAN (R 4.3.0)
 golem                    0.4.1     2023-06-05 [1] CRAN (R 4.3.0)
 gridExtra              * 2.3       2017-09-09 [1] CRAN (R 4.3.0)
 gtable                   0.3.4     2023-08-21 [1] CRAN (R 4.3.0)
 here                     1.0.1     2020-12-13 [1] CRAN (R 4.3.0)
 htmltools                0.5.7     2023-11-03 [1] CRAN (R 4.3.1)
 htmlwidgets              1.6.2     2023-03-17 [1] CRAN (R 4.3.0)
 httpuv                   1.6.12    2023-10-23 [1] CRAN (R 4.3.1)
 httr                     1.4.7     2023-08-15 [1] CRAN (R 4.3.0)
 hypeR                    2.0.0     2023-10-24 [1] Bioconductor
 igraph                   1.5.1     2023-08-10 [1] CRAN (R 4.3.0)
 interactiveDisplayBase   1.40.0    2023-10-24 [1] Bioconductor
 IRanges                * 2.36.0    2023-10-26 [1] Bioconductor
 irlba                    2.3.5.1   2022-10-03 [1] CRAN (R 4.3.1)
 iterators                1.0.14    2022-02-05 [1] CRAN (R 4.3.0)
 jquerylib                0.1.4     2021-04-26 [1] CRAN (R 4.3.0)
 jsonlite                 1.8.7     2023-06-29 [1] CRAN (R 4.3.0)
 kableExtra               1.3.4     2021-02-20 [1] CRAN (R 4.3.0)
 KEGGREST                 1.42.0    2023-10-26 [1] Bioconductor
 knitr                    1.45      2023-10-30 [1] CRAN (R 4.3.1)
 later                    1.3.1     2023-05-02 [1] CRAN (R 4.3.0)
 lattice                  0.22-5    2023-10-24 [1] CRAN (R 4.3.1)
 lazyeval                 0.2.2     2019-03-15 [1] CRAN (R 4.3.0)
 lifecycle                1.0.4     2023-11-07 [1] CRAN (R 4.3.1)
 limma                    3.58.1    2023-10-31 [1] Bioconductor
 locfit                   1.5-9.8   2023-06-11 [1] CRAN (R 4.3.0)
 magick                   2.8.1     2023-10-22 [1] CRAN (R 4.3.1)
 magrittr                 2.0.3     2022-03-30 [1] CRAN (R 4.3.0)
 maps                     3.4.1.1   2023-11-03 [1] CRAN (R 4.3.1)
 MASS                     7.3-60    2023-05-04 [1] CRAN (R 4.3.0)
 Matrix                   1.6-3     2023-11-14 [1] CRAN (R 4.3.1)
 MatrixGenerics         * 1.14.0    2023-10-26 [1] Bioconductor
 matrixStats            * 1.1.0     2023-11-07 [1] CRAN (R 4.3.1)
 memoise                  2.0.1     2021-11-26 [1] CRAN (R 4.3.0)
 metapod                  1.10.0    2023-10-24 [1] Bioconductor
 mime                     0.12      2021-09-28 [1] CRAN (R 4.3.0)
 msigdbr                  7.5.1     2022-03-30 [1] CRAN (R 4.3.0)
 munsell                  0.5.0     2018-06-12 [1] CRAN (R 4.3.0)
 openxlsx                 4.2.5.2   2023-02-06 [1] CRAN (R 4.3.0)
 paletteer                1.5.0     2022-10-19 [1] CRAN (R 4.3.0)
 pillar                   1.9.0     2023-03-22 [1] CRAN (R 4.3.0)
 pkgconfig                2.0.3     2019-09-22 [1] CRAN (R 4.3.0)
 plotly                   4.10.3    2023-10-21 [1] CRAN (R 4.3.1)
 plyr                     1.8.9     2023-10-02 [1] CRAN (R 4.3.1)
 png                      0.1-8     2022-11-29 [1] CRAN (R 4.3.0)
 polyclip                 1.10-6    2023-09-27 [1] CRAN (R 4.3.1)
 promises                 1.2.1     2023-08-10 [1] CRAN (R 4.3.0)
 purrr                    1.0.2     2023-08-10 [1] CRAN (R 4.3.0)
 R6                       2.5.1     2021-08-19 [1] CRAN (R 4.3.0)
 rappdirs                 0.3.3     2021-01-31 [1] CRAN (R 4.3.0)
 RColorBrewer             1.1-3     2022-04-03 [1] CRAN (R 4.3.0)
 Rcpp                     1.0.11    2023-07-06 [1] CRAN (R 4.3.1)
 RCurl                    1.98-1.13 2023-11-02 [1] CRAN (R 4.3.1)
 reactable                0.4.4     2023-03-12 [1] CRAN (R 4.3.0)
 rematch2                 2.1.2     2020-05-01 [1] CRAN (R 4.3.0)
 reshape2                 1.4.4     2020-04-09 [1] CRAN (R 4.3.0)
 restfulr                 0.0.15    2022-06-16 [1] CRAN (R 4.3.0)
 rjson                    0.2.21    2022-01-09 [1] CRAN (R 4.3.0)
 rlang                  * 1.1.2     2023-11-04 [1] CRAN (R 4.3.1)
 rmarkdown                2.25      2023-09-18 [1] CRAN (R 4.3.1)
 rprojroot                2.0.4     2023-11-05 [1] CRAN (R 4.3.1)
 Rsamtools                2.18.0    2023-10-24 [1] Bioconductor
 RSQLite                  2.3.3     2023-11-04 [1] CRAN (R 4.3.1)
 rstudioapi               0.15.0    2023-07-07 [1] CRAN (R 4.3.0)
 rsvd                     1.0.5     2021-04-16 [1] CRAN (R 4.3.0)
 rtracklayer              1.62.0    2023-10-26 [1] Bioconductor
 rvest                    1.0.3     2022-08-19 [1] CRAN (R 4.3.0)
 S4Arrays                 1.2.0     2023-10-26 [1] Bioconductor
 S4Vectors              * 0.40.1    2023-10-26 [1] Bioconductor
 sass                     0.4.7     2023-07-15 [1] CRAN (R 4.3.0)
 ScaledMatrix             1.10.0    2023-10-24 [1] Bioconductor
 scales                   1.2.1     2022-08-20 [1] CRAN (R 4.3.0)
 scater                 * 1.30.1    2023-11-16 [1] Bioconductor
 scran                  * 1.30.0    2023-10-24 [1] Bioconductor
 scuttle                * 1.12.0    2023-10-24 [1] Bioconductor
 sessioninfo              1.2.2     2021-12-06 [1] CRAN (R 4.3.0)
 shiny                    1.8.0     2023-11-17 [1] CRAN (R 4.3.1)
 shinyWidgets             0.8.0     2023-08-30 [1] CRAN (R 4.3.0)
 SingleCellExperiment   * 1.24.0    2023-11-06 [1] Bioconductor
 spam                     2.10-0    2023-10-23 [1] CRAN (R 4.3.1)
 SparseArray              1.2.2     2023-11-08 [1] Bioconductor
 sparseMatrixStats        1.14.0    2023-10-24 [1] Bioconductor
 SpatialExperiment      * 1.12.0    2023-10-24 [1] Bioconductor
 spatialLIBD            * 1.13.4    2023-05-25 [1] Bioconductor
 statmod                  1.5.0     2023-01-06 [1] CRAN (R 4.3.0)
 stringi                  1.8.1     2023-11-13 [1] CRAN (R 4.3.1)
 stringr                  1.5.1     2023-11-14 [1] CRAN (R 4.3.1)
 SummarizedExperiment   * 1.32.0    2023-11-06 [1] Bioconductor
 svglite                  2.1.2     2023-10-11 [1] CRAN (R 4.3.1)
 systemfonts              1.0.5     2023-10-09 [1] CRAN (R 4.3.1)
 tibble                   3.2.1     2023-03-20 [1] CRAN (R 4.3.0)
 tidyr                    1.3.0     2023-01-24 [1] CRAN (R 4.3.0)
 tidyselect               1.2.0     2022-10-10 [1] CRAN (R 4.3.0)
 tweenr                   2.0.2     2022-09-06 [1] CRAN (R 4.3.0)
 utf8                     1.2.4     2023-10-22 [1] CRAN (R 4.3.1)
 vctrs                    0.6.4     2023-10-12 [1] CRAN (R 4.3.1)
 vipor                    0.4.5     2017-03-22 [1] CRAN (R 4.3.0)
 viridis                  0.6.4     2023-07-22 [1] CRAN (R 4.3.0)
 viridisLite              0.4.2     2023-05-02 [1] CRAN (R 4.3.0)
 visNetwork               2.1.2     2022-09-29 [1] CRAN (R 4.3.0)
 webshot                  0.5.5     2023-06-26 [1] CRAN (R 4.3.0)
 withr                    2.5.2     2023-10-30 [1] CRAN (R 4.3.1)
 xfun                     0.41      2023-11-01 [1] CRAN (R 4.3.1)
 XML                      3.99-0.15 2023-11-02 [1] CRAN (R 4.3.1)
 xml2                     1.3.5     2023-07-06 [1] CRAN (R 4.3.0)
 xtable                   1.8-4     2019-04-21 [1] CRAN (R 4.3.0)
 XVector                * 0.42.0    2023-10-26 [1] Bioconductor
 yaml                     2.3.7     2023-01-23 [1] CRAN (R 4.3.0)
 zip                      2.3.0     2023-04-17 [1] CRAN (R 4.3.0)
 zlibbioc                 1.48.0    2023-10-26 [1] Bioconductor

 [1] /Users/bmulvey/Library/R/arm64/4.3/library
 [2] /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library

──────────────────────────────────────────────────────────────────────────
