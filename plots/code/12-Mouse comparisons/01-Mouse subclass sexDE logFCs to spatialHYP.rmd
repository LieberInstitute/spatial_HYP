---
title: "01-Mouse subclass sexDE logFCs to spatialHYP"
author: "Bernard Mulvey"
date: "2024-01-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.height = 10,fig.width = 7,include = FALSE)
knitr::opts_chunk$set(fig.width=7,fig.height=10)
#### sets tab autocompletion for directories to begin from the directory containing the .Rproj session, instead of the script's directory if different
knitr::opts_knit$set(root.dir = here::here())

library(data.table)
library(pheatmap)
```

```{r}
correls <- fread("data/12-Mouse comparisons/03-Yao23-subclass-MvFsexDE_logFCcorrels_to_singleSpDom-MvF.txt")

## 
correls[human_domain=="X11",human_domain:="VMH.1"]
correls[human_domain=="X12",human_domain:="VMH.2"]
correls[human_domain=="X3",human_domain:="ARC.1"]
correls[human_domain=="X5",human_domain:="ARC.2"]
correls[human_domain=="X1",human_domain:="WM.1"]
correls[human_domain=="X9",human_domain:="WM.2"]

correls <- correls[human_domain %in% c("VMH.1","VMH.2","ARC.1","ARC.2","WM.1","WM.2")]

pccs <- dcast(correls, mouse_subclass ~ human_domain, value.var = "pcc")
spears <- dcast(correls, mouse_subclass ~ human_domain, value.var="spearmancor")

pccs <- as.data.frame(pccs)
rownames(pccs) <- pccs$mouse_subclass
pccs$mouse_subclass <- NULL

spears <- as.data.frame(spears)
rownames(spears) <- spears$mouse_subclass
spears$mouse_subclass <- NULL

pdf("plots/12-Comparisons to other mouse and human datasets/01-Yaosubclass_sexDE_vs_visium_Pearsoncors.pdf",height=10,width=7)
pheatmap(as.matrix(pccs),treeheight_col=0,treeheight_row = 0)
dev.off()


pdf("plots/12-Comparisons to other mouse and human datasets/01-Yaosubclass_sexDE_vs_visium_spearmancors.pdf",height=10,width=7)
pheatmap(as.matrix(spears),treeheight_col=0,treeheight_row = 0)
dev.off()
```

```{r}
sessionInfo()
sessioninfo::session_info()
```
R version 4.3.2 (2023-10-31)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS Ventura 13.6

Matrix products: default
BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Chicago
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] pheatmap_1.0.12    data.table_1.14.10 rlang_1.1.3       

loaded via a namespace (and not attached):
 [1] KEGGREST_1.42.0         gtable_0.3.4            xfun_0.41              
 [4] Biobase_2.62.0          vctrs_0.6.5             tools_4.3.2            
 [7] bitops_1.0-7            generics_0.1.3          stats4_4.3.2           
[10] curl_5.2.0              Polychrome_1.5.1        tibble_3.2.1           
[13] fansi_1.0.6             AnnotationDbi_1.64.1    RSQLite_2.3.4          
[16] blob_1.2.4              pkgconfig_2.0.3         dbplyr_2.4.0           
[19] RColorBrewer_1.1-3      S4Vectors_0.40.2        scatterplot3d_0.3-44   
[22] lifecycle_1.0.4         GenomeInfoDbData_1.2.11 compiler_4.3.2         
[25] stringr_1.5.1           Biostrings_2.70.1       progress_1.2.3         
[28] munsell_0.5.0           GenomeInfoDb_1.38.5     htmltools_0.5.7        
[31] RCurl_1.98-1.14         yaml_2.3.8              pillar_1.9.0           
[34] crayon_1.5.2            cachem_1.0.8            sessioninfo_1.2.2      
[37] tidyselect_1.2.0        digest_0.6.33           stringi_1.8.3          
[40] dplyr_1.1.4             grid_4.3.2              biomaRt_2.58.0         
[43] rprojroot_2.0.4         fastmap_1.1.1           colorspace_2.1-0       
[46] here_1.0.1              cli_3.6.2               magrittr_2.0.3         
[49] XML_3.99-0.16           utf8_1.2.4              scales_1.3.0           
[52] prettyunits_1.2.0       filelock_1.0.3          rappdirs_0.3.3         
[55] bit64_4.0.5             rmarkdown_2.25          XVector_0.42.0         
[58] httr_1.4.7              bit_4.0.5               png_0.1-8              
[61] hms_1.1.3               memoise_2.0.1           evaluate_0.23          
[64] knitr_1.45              IRanges_2.36.0          BiocFileCache_2.10.1   
[67] glue_1.7.0              DBI_1.2.0               xml2_1.3.6             
[70] BiocGenerics_0.48.1     rstudioapi_0.15.0       R6_2.5.1               
[73] zlibbioc_1.48.0        
> sessioninfo::session_info()
─ Session info ───────────────────────────────────────────────────────────
 setting  value
 version  R version 4.3.2 (2023-10-31)
 os       macOS Ventura 13.6
 system   aarch64, darwin20
 ui       RStudio
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Chicago
 date     2024-01-10
 rstudio  2023.09.1+494 Desert Sunflower (desktop)
 pandoc   3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────
 package          * version   date (UTC) lib source
 AnnotationDbi      1.64.1    2023-11-02 [1] Bioconductor
 Biobase            2.62.0    2023-10-26 [1] Bioconductor
 BiocFileCache      2.10.1    2023-10-26 [1] Bioconductor
 BiocGenerics       0.48.1    2023-11-02 [1] Bioconductor
 biomaRt            2.58.0    2023-10-24 [1] Bioconductor
 Biostrings         2.70.1    2023-10-26 [1] Bioconductor
 bit                4.0.5     2022-11-15 [1] CRAN (R 4.3.0)
 bit64              4.0.5     2020-08-30 [1] CRAN (R 4.3.0)
 bitops             1.0-7     2021-04-24 [1] CRAN (R 4.3.0)
 blob               1.2.4     2023-03-17 [1] CRAN (R 4.3.0)
 cachem             1.0.8     2023-05-01 [1] CRAN (R 4.3.0)
 cli                3.6.2     2023-12-11 [1] CRAN (R 4.3.1)
 colorspace         2.1-0     2023-01-23 [1] CRAN (R 4.3.0)
 crayon             1.5.2     2022-09-29 [1] CRAN (R 4.3.0)
 curl               5.2.0     2023-12-08 [1] CRAN (R 4.3.1)
 data.table       * 1.14.10   2023-12-08 [1] CRAN (R 4.3.2)
 DBI                1.2.0     2023-12-21 [1] CRAN (R 4.3.1)
 dbplyr             2.4.0     2023-10-26 [1] CRAN (R 4.3.1)
 digest             0.6.33    2023-07-07 [1] CRAN (R 4.3.0)
 dplyr              1.1.4     2023-11-17 [1] CRAN (R 4.3.1)
 evaluate           0.23      2023-11-01 [1] CRAN (R 4.3.1)
 fansi              1.0.6     2023-12-08 [1] CRAN (R 4.3.1)
 fastmap            1.1.1     2023-02-24 [1] CRAN (R 4.3.0)
 filelock           1.0.3     2023-12-11 [1] CRAN (R 4.3.1)
 generics           0.1.3     2022-07-05 [1] CRAN (R 4.3.0)
 GenomeInfoDb       1.38.5    2023-12-30 [1] Bioconductor 3.18 (R 4.3.2)
 GenomeInfoDbData   1.2.11    2023-11-10 [1] Bioconductor
 glue               1.7.0     2024-01-09 [1] CRAN (R 4.3.1)
 gtable             0.3.4     2023-08-21 [1] CRAN (R 4.3.0)
 here               1.0.1     2020-12-13 [1] CRAN (R 4.3.0)
 hms                1.1.3     2023-03-21 [1] CRAN (R 4.3.0)
 htmltools          0.5.7     2023-11-03 [1] CRAN (R 4.3.1)
 httr               1.4.7     2023-08-15 [1] CRAN (R 4.3.0)
 IRanges            2.36.0    2023-10-26 [1] Bioconductor
 KEGGREST           1.42.0    2023-10-26 [1] Bioconductor
 knitr              1.45      2023-10-30 [1] CRAN (R 4.3.1)
 lifecycle          1.0.4     2023-11-07 [1] CRAN (R 4.3.1)
 magrittr           2.0.3     2022-03-30 [1] CRAN (R 4.3.0)
 memoise            2.0.1     2021-11-26 [1] CRAN (R 4.3.0)
 munsell            0.5.0     2018-06-12 [1] CRAN (R 4.3.0)
 pheatmap         * 1.0.12    2019-01-04 [1] CRAN (R 4.3.0)
 pillar             1.9.0     2023-03-22 [1] CRAN (R 4.3.0)
 pkgconfig          2.0.3     2019-09-22 [1] CRAN (R 4.3.0)
 png                0.1-8     2022-11-29 [1] CRAN (R 4.3.0)
 Polychrome         1.5.1     2022-05-03 [1] CRAN (R 4.3.0)
 prettyunits        1.2.0     2023-09-24 [1] CRAN (R 4.3.1)
 progress           1.2.3     2023-12-06 [1] CRAN (R 4.3.1)
 R6                 2.5.1     2021-08-19 [1] CRAN (R 4.3.0)
 rappdirs           0.3.3     2021-01-31 [1] CRAN (R 4.3.0)
 RColorBrewer       1.1-3     2022-04-03 [1] CRAN (R 4.3.0)
 RCurl              1.98-1.14 2024-01-09 [1] CRAN (R 4.3.1)
 rlang            * 1.1.3     2024-01-10 [1] CRAN (R 4.3.2)
 rmarkdown          2.25      2023-09-18 [1] CRAN (R 4.3.1)
 rprojroot          2.0.4     2023-11-05 [1] CRAN (R 4.3.1)
 RSQLite            2.3.4     2023-12-08 [1] CRAN (R 4.3.1)
 rstudioapi         0.15.0    2023-07-07 [1] CRAN (R 4.3.0)
 S4Vectors          0.40.2    2023-11-25 [1] Bioconductor 3.18 (R 4.3.2)
 scales             1.3.0     2023-11-28 [1] CRAN (R 4.3.1)
 scatterplot3d      0.3-44    2023-05-05 [1] CRAN (R 4.3.0)
 sessioninfo        1.2.2     2021-12-06 [1] CRAN (R 4.3.0)
 stringi            1.8.3     2023-12-11 [1] CRAN (R 4.3.1)
 stringr            1.5.1     2023-11-14 [1] CRAN (R 4.3.1)
 tibble             3.2.1     2023-03-20 [1] CRAN (R 4.3.0)
 tidyselect         1.2.0     2022-10-10 [1] CRAN (R 4.3.0)
 utf8               1.2.4     2023-10-22 [1] CRAN (R 4.3.1)
 vctrs              0.6.5     2023-12-01 [1] CRAN (R 4.3.1)
 xfun               0.41      2023-11-01 [1] CRAN (R 4.3.1)
 XML                3.99-0.16 2023-11-29 [1] CRAN (R 4.3.1)
 xml2               1.3.6     2023-12-04 [1] CRAN (R 4.3.1)
 XVector            0.42.0    2023-10-26 [1] Bioconductor
 yaml               2.3.8     2023-12-11 [1] CRAN (R 4.3.1)
 zlibbioc           1.48.0    2023-10-26 [1] Bioconductor

 [1] /Users/bmulvey/Library/R/arm64/4.3/library
 [2] /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library

──────────────────────────────────────────────────────────────────────────
